<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sector Cycle Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #fff; }
        .chart-container { position: relative; width: 100vw; max-width: 600px; aspect-ratio: 1; }
        canvas { width: 100% !important; height: 100% !important; }
    </style>
</head>
<body>
    <div class="chart-container">
        <canvas id="sectorCycleChart"></canvas>
    </div>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        var ctx = document.getElementById('sectorCycleChart');
        
        // 四隅に表示するセクターリスト
        const sectorLabels = {
            NW: ["電機・精密", "情報通信", "建設・資材"],
            NE: ["自動車", "機械", "商社・卸売"],
            SE: ["銀行", "金融(除)", "エネルギー"],
            SW: ["医薬品", "食品", "小売"]
        };

        var bgPlugin = {
            id: 'bgPlugin',
            beforeDraw: function(chart) {
                var ctx = chart.ctx;
                var ca = chart.chartArea;
                var x = chart.scales.x;
                var y = chart.scales.y;
                var midX = x.getPixelForValue(0);
                var midY = y.getPixelForValue(0);
                
                ctx.save();
                
                // --- 背景色の描画 ---
                // 北西 (回復): 芽吹き、若草色/シアン系
                ctx.fillStyle = 'rgba(225, 250, 240, 0.5)';
                ctx.fillRect(ca.left, ca.top, midX - ca.left, midY - ca.top);
                
                // 北東 (好況): 過熱、赤/オレンジ系
                ctx.fillStyle = 'rgba(255, 235, 235, 0.5)';
                ctx.fillRect(midX, ca.top, ca.left + ca.width - midX, midY - ca.top);
                
                // 南東 (後退): 警戒、黄色/アンバー系
                ctx.fillStyle = 'rgba(255, 252, 230, 0.5)';
                ctx.fillRect(midX, midY, ca.left + ca.width - midX, ca.top + ca.height - midY);
                
                // 南西 (不況): 冷え込み、青紫/グレー系
                ctx.fillStyle = 'rgba(235, 235, 250, 0.5)';
                ctx.fillRect(ca.left, midY, midX - ca.left, ca.top + ca.height - midY);
                
                // --- 十字線の描画 (少し濃く) ---
                ctx.strokeStyle = 'rgba(0,0,0,0.2)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(midX, ca.top); ctx.lineTo(midX, ca.bottom);
                ctx.moveTo(ca.left, midY); ctx.lineTo(ca.right, midY);
                ctx.stroke();

                // --- テキスト描画設定 ---
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                // エリア名 (中央寄り)
                ctx.font = 'bold 16px sans-serif';
                ctx.fillStyle = 'rgba(0,0,0,0.4)';
                ctx.fillText('回復期', (ca.left + midX)/2, (ca.top + midY)/2);
                ctx.fillText('好況期', (midX + ca.right)/2, (ca.top + midY)/2);
                ctx.fillText('後退期', (midX + ca.right)/2, (midY + ca.bottom)/2);
                ctx.fillText('不況期', (ca.left + midX)/2, (midY + ca.bottom)/2);

                // --- 四隅の業種名描画 ---
                ctx.font = '10px sans-serif';
                ctx.fillStyle = 'rgba(0,0,0,0.5)';
                var pad = 10;
                var lineHeight = 12;

                // NW (左上)
                ctx.textAlign = 'left';
                ctx.textBaseline = 'top';
                sectorLabels.NW.forEach((text, i) => {
                    ctx.fillText(text, ca.left + pad, ca.top + pad + (i * lineHeight));
                });

                // NE (右上)
                ctx.textAlign = 'right';
                sectorLabels.NE.forEach((text, i) => {
                    ctx.fillText(text, ca.right - pad, ca.top + pad + (i * lineHeight));
                });

                // SE (右下)
                ctx.textAlign = 'right';
                ctx.textBaseline = 'bottom';
                sectorLabels.SE.slice().reverse().forEach((text, i) => {
                    ctx.fillText(text, ca.right - pad, ca.bottom - pad - (i * lineHeight));
                });

                // SW (左下)
                ctx.textAlign = 'left';
                ctx.textBaseline = 'bottom';
                sectorLabels.SW.slice().reverse().forEach((text, i) => {
                    ctx.fillText(text, ca.left + pad, ca.bottom - pad - (i * lineHeight));
                });

                ctx.restore();
            }
        };

        new Chart(ctx, {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        // 軌跡
                        label: '軌跡',
                        data: [{"x": -0.32, "y": -0.65}, {"x": -1.31, "y": 1.76}, {"x": -1.61, "y": 3.16}, {"x": -0.92, "y": 2.02}, {"x": 0.61, "y": -0.62}, {"x": 1.21, "y": 0.01}, {"x": 6.0, "y": -2.33}, {"x": 3.8, "y": -3.36}, {"x": -1.53, "y": 0.73}, {"x": -3.39, "y": -0.46}, {"x": -0.36, "y": 1.73}, {"x": -0.85, "y": 3.41}, {"x": 1.85, "y": 5.13}, {"x": 3.92, "y": 4.9}, {"x": 2.75, "y": 3.91}, {"x": 1.79, "y": 3.99}, {"x": 0.82, "y": 6.75}, {"x": 0.77, "y": 4.51}, {"x": 1.23, "y": 3.96}, {"x": 3.28, "y": 4.63}, {"x": 3.37, "y": 4.91}, {"x": 5.18, "y": 4.14}, {"x": 6.22, "y": 1.46}, {"x": 5.83, "y": 0.21}, {"x": 5.08, "y": 1.89}, {"x": 7.26, "y": 0.93}, {"x": 4.33, "y": 5.05}, {"x": 2.03, "y": 5.05}, {"x": 3.24, "y": 8.96}, {"x": 2.54, "y": 5.94}, {"x": 2.13, "y": 0.6}, {"x": 0.47, "y": -4.05}, {"x": 2.9, "y": -2.38}, {"x": 5.14, "y": -3.31}, {"x": 3.93, "y": -3.62}, {"x": 4.7, "y": -2.05}, {"x": 10.84, "y": -2.49}, {"x": 9.83, "y": -4.07}],
                        borderWidth: 2,
                        pointRadius: 0,
                        showLine: true,
                        segment: {
                            borderColor: function(ctx) {
                                var count = ctx.chart.data.datasets[0].data.length;
                                var val = ctx.p1DataIndex / count;
                                var alpha = 0.1 + (0.9 * val);
                                return 'rgba(80, 80, 80, ' + alpha + ')';
                            }
                        },
                        order: 2
                    },
                    {
                        // 現在地点
                        label: '現在',
                        data: [{"x": 9.83, "y": -4.07}],
                        backgroundColor: 'rgba(255, 0, 0, 1)',
                        borderColor: '#fff',
                        borderWidth: 2,
                        pointRadius: 8,
                        pointHoverRadius: 10,
                        order: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { 
                        min: -25, max: 25,
                        grid: {
                            display: true, // グリッド表示ON
                            color: 'rgba(0, 0, 0, 0.05)', // 薄いグレー
                            drawTicks: false
                        }, 
                        ticks: {display: false} 
                    },
                    y: { 
                        min: -25, max: 25,
                        grid: {
                            display: true, // グリッド表示ON
                            color: 'rgba(0, 0, 0, 0.05)', // 薄いグレー
                            drawTicks: false
                        }, 
                        ticks: {display: false} 
                    }
                },
                plugins: { legend: {display: false}, tooltip: {enabled: false} }
            },
            plugins: [bgPlugin]
        });
    });
    </script>
</body>
</html>